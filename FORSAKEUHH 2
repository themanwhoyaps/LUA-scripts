-- functions lol

local function highlightObject(object : Instance, evil : boolean)
	local newKillerHighlight = Instance.new("Highlight")
	local newFloatGUI = Instance.new("BillboardGui")
	local newTextlabel = Instance.new("TextLabel")
	newTextlabel.Parent = newFloatGUI
	-- fallback incase hrp doesnt exist
	if object:WaitForChild("HumanoidRootPart", 5) == nil then
		newFloatGUI.Parent = object
	else 
		newFloatGUI.Parent = object:FindFirstChild("HumanoidRootPart")
	end
	
	newFloatGUI.Name = "espBillboard"
	newKillerHighlight.Parent = object
	
	newFloatGUI.ExtentsOffsetWorldSpace = Vector3.new(0, 3.5, 0)
	newFloatGUI.Size = UDim2.new(10, 0, 1.5, 0)
	newFloatGUI.AlwaysOnTop = true
	
	newTextlabel.Size = UDim2.new(1, 0, 1, 0)
	newTextlabel.FontFace.Bold = true
	newTextlabel.TextScaled = true
	newTextlabel.BackgroundTransparency = 1
	newTextlabel.TextStrokeTransparency = 0
	newTextlabel.FontFace = Font.fromName("Roboto", Enum.FontWeight.Bold, Enum.FontStyle.Normal)
	newTextlabel.Text = object.Name
	
	if evil then
		newKillerHighlight.Name = "evilHighlightLMAO"
		newKillerHighlight.FillColor = Color3.fromRGB(208, 0, 0)
		newKillerHighlight.OutlineColor = Color3.fromRGB(153, 1, 1)
		
		newTextlabel.TextColor3 = Color3.fromRGB(225, 93, 95)
	else
		newKillerHighlight.Name = "coolHighlightLMAO"
		newKillerHighlight.FillColor = Color3.fromRGB(132, 132, 0)
		newKillerHighlight.OutlineColor = Color3.fromRGB(199, 189, 52)
		
		newTextlabel.TextColor3 = Color3.fromRGB(255, 242, 58)
	end
end

-- setup yawn

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
	Name = "Forsaken Whatever",
	Icon = "scroll-text", -- Icon in Topbar. Can use Lucide Icons (string) or Roblox Image (number). 0 to use no icon (default).
	LoadingTitle = "Believe in these lies",
	LoadingSubtitle = "XD",
	ShowText = "the scripts :?", -- for mobile users to unhide rayfield, change if you'd like
	Theme = "DarkBlue", -- Check https://docs.sirius.menu/rayfield/configuration/themes

	ToggleUIKeybind = "K", -- The keybind to toggle the UI visibility (string like "K" or Enum.KeyCode)

	DisableRayfieldPrompts = false,
	DisableBuildWarnings = false, -- Prevents Rayfield from warning when the script has a version mismatch with the interface
})

if game.PlaceId ~= 18687417158 then
	Rayfield:Notify({
		Title = "Forsaken Whatever",
		Content = "Unsupported game!!1!, Shutting down...",
		Duration = 3,
		Image = "triangle-alert",
	})
	task.wait(3)
	Rayfield:Destroy()
	return
end

-- more boring variables lol
local killerfolder = workspace.Players.Killers
local survivorfolder = workspace.Players.Survivors
local killerESPWatch
local survivorESPWatch

-- ui setup (yawn)

local sf = Window:CreateTab("Safe Functions", "square-plus") -- safe functions
local uf = Window:CreateTab("Unsafe Functions", "square-minus") -- unsafe functions

local ufWarningSection = uf:CreateSection("These functions have a greater risk of getting reported and banned! Use at your own risk.")
local sfWarningSection = sf:CreateSection("These functions are undetectable and not easy to get banned with.")

-- // objects for Safe Functions //

local killerESP = sf:CreateToggle({
	Name = "Highlight killer(s)",
	CurrentValue = false,
	Flag = "Toggle1",
	Callback = function(Value)
		if Value then
			for i, killerChar in killerfolder:GetChildren() do
				highlightObject(killerChar, true)
			end
			
			killerESPWatch = killerfolder.ChildAdded:Connect(function(object)
				highlightObject(object, true)
			end)
		else
			if killerESPWatch then
				killerESPWatch:Disconnect()
				killerESPWatch = nil
			end
			
			for i, v in killerfolder:GetDescendants() do
				if v.Name == "evilHighlightLMAO" or v.Name == "espBillboard" then
					v:Destroy()
				end
			end
		end
	end,
})

local survivorESP = sf:CreateToggle({
	Name = "Highlight survivors",
	CurrentValue = false,
	Flag = "Toggle1",
	Callback = function(Value)
		if Value then
			for i, survivorChar in survivorfolder:GetChildren() do
				highlightObject(survivorChar, false)
			end

			survivorESPWatch = survivorfolder.ChildAdded:Connect(function(object)
				highlightObject(object, false)
			end)
		else
			if survivorESPWatch then
				survivorESPWatch:Disconnect()
				survivorESPWatch = nil
			end

			for i, v in survivorfolder:GetDescendants() do
				if v.Name == "coolHighlightLMAO" or v.Name == "espBillboard" then
					v:Destroy()
				end
			end
		end
		
	end,
})
